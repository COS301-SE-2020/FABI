<br>
<!-- Testing camera functionality -->
<div class="col-sm-6" *ngIf="ImageDataCount<3&&!enterImage">
  <div class="row" [style.visibility]="showWebcam?'visible':'hidden'">
      <div class="col-sm-6" style="text-align: center;max-width: 50%;">
        <webcam 
        [width]="300"
        [trigger]="triggerObservable" (imageCapture)="handleImage($event)"
        [allowCameraSwitch]="allowCameraSwitch" [switchCamera]="nextWebcamObservable"
        [videoOptions]="videoOptions"
        [imageQuality]="1"
        (cameraSwitched)="cameraWasSwitched($event)"
        (initError)="handleInitError($event)">
        </webcam>
      </div>
  <br/>
</div>

<div class="row">
  <br/>
  <div class="col-6" [style.visibility]="showWebcam?'visible':'hidden'"><button class="btn btn-success" (click)="triggerSnapshot();enterImage=true;"><i class="fa fa-camera"></i> Take photo</button></div>
  <div class="col-6" ><button class="btn btn-success" (click)="toggleWebcam();">Toggle Webcam</button></div>
</div>

<div class="row">
  <div class="col-3" *ngIf="multipleWebcamsAvailable">
      <button class="btn btn-success" (click)="showNextWebcam(true);" [disabled]="!multipleWebcamsAvailable">Next Webcam</button>
      <input id="cameraSwitchCheckbox" type="checkbox" [(ngModel)]="allowCameraSwitch"><label for="cameraSwitchCheckbox">Allow Camera Switch</label>
      DeviceId: <input id="deviceId" type="text" [(ngModel)]="deviceId" style="width: 500px">
      <button class="btn btn-success" (click)="showNextWebcam(deviceId);">Activate</button>
  </div>
</div>
</div>
<h4 *ngIf="errors.length > 0">Messages:</h4>
<ul *ngFor="let error of errors">
<li>{{error.message}}</li>
</ul>

<div class="row" *ngIf="!enterImage">
  <div class="col-md-4" *ngFor="let Image of Images;let i = index;">
    <div class="thumbnail">
        <img src="{{Image.src}}" alt="Lights" style="width:100%">
        <div class="caption">
          <p>Description: {{Answers.Images["Image"+(i+1)].ImageDescription}}</p>
        </div>
    </div>
  </div>
</div>

<button class="btn btn-danger" (click)="clearImages();" *ngIf="ImageDataCount==3&&!enterImage">Reset Images</button>

<form [formGroup]="ImageData" *ngIf="ImageDataCount<3&&enterImage">
  <img src="{{Images[Images.length-1].src}}" alt="Lights" style="width:100%">
  <div class="input-group">
    <div class="input-group-prepend">
      <span class="input-group-text">Please enter a short description for this image: </span>
    </div>
    <textarea class="form-control" formControlName="Description" maxlength="25"></textarea>
  </div>

<button class="btn btn-primary" (click)="setImageData();">Confirm</button>
</form>   

<div *ngIf="ImageDataCount==3&&!enterImage">
<br/>
      <h5 class="unselectable">Location:</h5>
      <div class="input-group" style="opacity: 0.9;pointer-events: none;">
      <input type="text" aria-label="Latitude" class="form-control" value="{{Lat}}">
      <input type="text" aria-label="Longitude" class="form-control" value="{{Long}}">
      <input type="text" aria-label="Accuracy" class="form-control" value="Within {{Answers.Location['Accuracy']}}m">
    </div>

    

<form [formGroup]="Plant">
  <input type="text" id="Date" name="Date" value="{{today | date:'dd MMMM yyyy'}}" style="visibility: hidden;"><br>
  
  <h5 class="unselectable">Plant information:</h5>
    <div class="input-group input-group-sm mb-3">
      <div class="input-group-prepend">
        <span class="input-group-text" id="inputGroup-sizing-sm">Common name:</span>
      </div>
      <input type="text" class="form-control" formControlName="Question1">
    </div>
    <div class="input-group input-group-sm mb-3">
      <div class="input-group-prepend">
        <span class="input-group-text" id="inputGroup-sizing-sm">Scientific Name: </span>
      </div>
      <input type="text" class="form-control" formControlName="Question2">
    </div>
    <div class="input-group input-group-sm mb-3">
      <div class="input-group-prepend">
        <span class="input-group-text" id="inputGroup-sizing-sm">Cultivar: </span>
      </div>
      <input type="text" class="form-control" formControlName="Question3">
    </div>
</form>

<form [formGroup]="PestOrDiseases">
  <div class="form-group">
    <label class="unselectable" for="PorD">My plant is affected by a: *</label>
    <select class="form-control" id="PorD" (change)="changeType()" formControlName="PorD">
      <option *ngFor="let option of PorD_Options" [ngValue]="option">{{option}}</option>
    </select>
  </div>
</form>

<form [formGroup]="PorD_Questions" *ngIf="PorD_Selected">
  <h4 class="unselectable">{{Answers.Questions["Pest Or Disease"]}} Questions:</h4>
  <div class="input-group input-group-sm mb-4">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">Where do you see the {{Answers.Questions["Pest Or Disease"]}} on the plant?</span>
    </div>
    <select class="form-control" (change)="change(4,$event)" formControlName="Question4">
      <option *ngFor="let option of Question4_Options" value="{{option}}">{{option}}</option>
    </select>
  </div>
  <div class="input-group input-group-sm mb-4">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">Do you know what {{Answers.Questions["Pest Or Disease"]}} is affecting the plant?</span>
    </div>
    <select class="form-control" (change)="change(5,$event)" formControlName="Question5">
      <option *ngFor="let option of YNOptions" value="{{option}}">{{option}}</option>
    </select>
  </div>
  <div class="input-group input-group-sm mb-4" [style.visibility]="Answers.Questions[QuestionDesc[4]]=='Yes'?'visible':'hidden'">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">What is its scientific or common name?</span>
    </div>
    <input type="text" class="form-control" formControlName="Question6">
  </div>
  <div class="input-group input-group-sm mb-4">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">How many plants are affected?</span>
    </div>
    <select class="form-control" (change)="change(7,$event)" formControlName="Question7">
      <option *ngFor="let option of MultiOptions" value="{{option}}">{{option}}</option>
    </select>
  </div>
  <div class="input-group input-group-sm mb-4" [style.visibility]="Answers.Questions[QuestionDesc[6]]=='More than one'?'visible':'hidden'">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">What percentage of plants are affected?</span>
    </div>
    <input type="text" class="form-control" formControlName="Question8">
  </div>
</form>

<form [formGroup]="Climate_Questions" *ngIf="PorD_Selected">
  <h4 class="unselectable">Climate Questions:</h4>
  <div class="input-group input-group-sm mb-4">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">Are you experiencing a drought?</span>
    </div>
    <select class="form-control" (change)="change(9,$event)" formControlName="Question9">
      <option *ngFor="let option of YNOptions" value="{{option}}">{{option}}</option>
    </select>
  </div>
  <div class="input-group input-group-sm mb-4">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">Have you experienced above average precipitation?</span>
    </div>
    <select class="form-control" (change)="change(10,$event)" formControlName="Question10">
      <option *ngFor="let option of YNOptions" value="{{option}}">{{option}}</option>
    </select>
  </div>
  <div class="input-group input-group-sm mb-4">
    <div class="input-group-prepend">
      <span class="input-group-text" id="inputGroup-sizing-sm">Any other climatic conditions worth specifying?</span>
    </div>
    <select class="form-control" (change)="change(11,$event)" formControlName="Question11_a">
      <option *ngFor="let option of YNOptions" value="{{option}}">{{option}}</option>
    </select>
    
  </div>
  <textarea class="form-control" style="resize: none;" formControlName="Question11_b" [style.visibility]="Answers.Questions[QuestionDesc[10]]=='Yes'?'visible':'hidden'"></textarea>
</form>
<br><button class="btn btn-success" style="margin-left: 5px;" *ngIf="PorD_Selected&&Images.length==3" (click)="onSubmit()">Submit Report</button>
</div>

<br><button type="button" class="btn btn-danger" style="margin-left: 5px;" *ngIf="Images.length==3" (click)="onCancel()">Cancel</button>
